! VIRTUAL_SERVER CONFIG FILE
! This file autogenerated by Chef
! Do not edit, changes will be overwritten

virtual_server <%= @vs_listen_ip %> <%= @vs_listen_port %> {
    delay_loop <%= @delay_loop %>	#  number of seconds between checks
    lb_algo <%= @lb_algo %>
    lb_kind <%= @lb_kind.upcase %>
    protocol <%= @vs_protocol.upcase %>

    <% @real_servers.each do |server| %>
    real_server <%= server['ip'] %> <%= server['port'] %> {
        <%= @vs_protocol.upcase %>_CHECK {
            connect_timeout 5
            connect_port <%= server['port'] %>
        }
    }
    <% end -%>
}
